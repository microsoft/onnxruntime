# Copyright (c) Qualcomm Technologies, Inc. and/or its subsidiaries.
# SPDX-License-Identifier: MIT

name: Qualcomm Internal PR Workflow
on:
  push:
    branches: [main, rel-*]
  pull_request:
    branches: [main, rel-*]

  # Allow this workflow to be run manually from the Actions tab
  workflow_dispatch:

# only one active job per PR. this will cause jobs to be immediately cancelled on subsequent pushes in PRs.
# ref: https://docs.github.com/en/actions/using-jobs/using-concurrency#example-using-a-fallback-value
concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}
  cancel-in-progress: true

jobs:
  build-and-test-all:
    name: Build & Test
    uses: ./.github/workflows/qualcomm-internal-build-and-test.yml
    secrets: inherit
    with:
      do_all: true

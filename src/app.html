<!DOCTYPE html>
<html lang="en" data-theme="lightmode">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.ico" />
		<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
		<meta name="viewport" content="width=device-width" />
		%sveltekit.head%
		<!-- Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156955408-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('consent', 'default', {
				ad_storage: 'denied',
				analytics_storage: 'denied'
			});
			gtag('js', new Date());
			gtag('config', 'UA-156955408-1');
		</script>
		<!-- Adobe Analytics -->
		<script type="text/javascript">
			const analytics = new oneDS.ApplicationInsights();
			var config = {
				instrumentationKey:
					'360b0e675e0044398fd28c8bdf711b8e-1fe5434d-ee99-4837-99cc-a3a16462d82d-7262',
				channelConfiguration: {
					// Post channel configuration
					eventsLimitInMem: 50
				},
				propertyConfiguration: {
					// Properties Plugin configuration
					env: 'PROD' // Environment can be set to PPE or PROD as needed.
				},
				webAnalyticsConfiguration: {
					// Web Analytics Plugin configuration
					//urlCollectQuery:true,
					autoCapture: {
						scroll: true,
						pageView: true,
						onLoad: true,
						onUnload: true,
						click: true,
						resize: true,
						jsError: true
					}
				}
			};
			//Initialize SDK
			analytics.initialize(config, []);
		</script>
		<!-- MS Analytics -->
		<script
			type="text/javascript"
			src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js"
		></script>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div id="cookie-banner"></div>
		<div style="display: contents">%sveltekit.body%</div>
	</body>
	<script>
		let choices = {
			marketing: false,
			tracking: false,
			analytics: {
				label: 'Analytics',
				description:
					'We use analytics cookies to track visits, helping create a better experience for you!',
				value: true
			},
			necessary: {
				label: 'Necessary',
				description: 'Used for cookie control.',
				value: true
			}
		};

		window.WcpConsent &&
			WcpConsent.init(
				'en-US',
				'cookie-banner',
				function (err, _siteConsent) {
					if (!err) {
						siteConsent = _siteConsent; //siteConsent is used to get the current consent
					} else {
						console.log('Error initializing WcpConsent: ' + err);
					}
				},
				onConsentChanged,
				WcpConsent.themes.light
			);

		function onConsentChanged(categoryPreferences) {
			if (categoryPreferences.Analytics) {
				// Google Analytics
				gtag('consent', 'update', {
					ad_storage: 'granted',
					analytics_storage: 'granted'
				});
				// Adobe Analytics
			}
		}
	</script>
</html>

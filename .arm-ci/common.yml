# common k8s cluster configurations
.default_settings:
  tags:
    - ealta-prod
  variables:
    KUBERNETES_CPU_REQUEST: "8"
    KUBERNETES_CPU_LIMIT: "10"
    KUBERNETES_MEMORY_REQUEST: "16Gi"
    KUBERNETES_MEMORY_LIMIT: "20Gi"
    KUBERNETES_NODE_SELECTOR_ARCH: 'kubernetes.io/arch=amd64'
    KUBERNETES_NODE_SELECTOR_TYPE: 'karpenter.sh/capacity-type=spot'
    FF_DISABLE_UMASK_FOR_DOCKER_EXECUTOR: true
    GIT_SUBMODULE_STRATEGY: recursive
# change directory to the cloned git dir so we can mark it as a safe dir for submodule cloning
.common_setup:
  before_script:
  - git config --global --add safe.directory "$CI_PROJECT_DIR"
  - |
    git submodule foreach --recursive \
    'git config --global --add safe.directory "$toplevel/$path"'
